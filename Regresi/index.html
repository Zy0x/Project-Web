<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Kalkulator Regresi</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js "></script>
    <style>
        /* Global Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f4f4f9;
            overflow: hidden; /* Prevent scrolling on the main body */
        }

        /* Container Styling */
        .container {
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            overflow-y: auto; /* Enable vertical scrolling if content overflows */
        }

        /* Button Styling */
        button {
            margin: 10px;
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            background-color: #0056b3;
        }

        /* Input and Table Styling */
        input {
            margin: 5px 0;
            padding: 5px;
            width: 80%;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
        }

        table, th, td {
            border: 1px solid black;
        }

        th, td {
            padding: 10px;
            text-align: center;
        }

        /* Scrollable Table */
        .scrollable-table-container {
            overflow-x: auto;
            width: 100%;
        }

        .scrollable-table-container table {
            min-width: 1000px; /* Minimum width for wide tables */
        }

        /* Penyelesaian Section */
        .penyelesaian {
            margin-top: 20px;
            text-align: left;
            font-size: 14px;
            line-height: 1.5;
            display: none; /* Hidden by default */
        }

        .penyelesaian h3 {
            margin-bottom: 10px;
        }

        /* Chart Styling */
        #regression-chart {
            width: 100%;
            max-width: 800px; /* Lebar maksimum */
            aspect-ratio: 16 / 9; /* Rasio aspek 16:9 */
            margin: 20px auto;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            input {
                width: 90%;
            }
        }

        /* Back Button */
        .back-button {
            position: absolute;
            top: 10px;
            left: 10px;
            padding: 10px 20px;
            background-color: #ff4d4d;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .back-button:hover {
            background-color: #cc0000;
        }
    </style>
</head>
<body>
    <div id="main-menu" class="container">
        <h1>Pilih Menu</h1>
        <button onclick="openMateri()">Materi</button>
        <button onclick="openCalculator()">Kalkulator</button>
    </div>

    <div id="calculator" class="container" style="display: none;">
        <h1>Kalkulator Analisis Regresi</h1>
        <div id="password-prompt" style="display: block;">
            <p>Masukkan Password:</p>
            <input type="password" id="password-input">
            <button onclick="verifyPassword()">Submit</button>
            <p id="error-message" style="color: red;"></p>
        </div>
        <div id="calculator-form" style="display: none;">
            <label for="n">Banyak Data (n):</label>
            <input type="number" id="n" min="2" required><br>
            <label for="decimal">Jumlah Angka di Belakang Koma:</label>
            <input type="number" id="decimal" min="0" required><br>
            <label for="varX">Nama Variabel X (Variabel yang Mempengaruhi):</label>
            <input type="text" id="varX" placeholder="Contoh: Jumlah Jam Belajar" required><br>
            <label for="varY">Nama Variabel Y (Variabel yang Dipengaruhi):</label>
            <input type="text" id="varY" placeholder="Contoh: Nilai Ujian" required><br>
            <button onclick="generateInputTable()">Lanjutkan</button>
            <div id="data-input"></div>
            <button id="calculate-btn" style="display: none;" onclick="calculateRegression()">Hitung</button>
            <div id="results"></div>
        </div>
    </div>

    <div id="materi" class="container" style="display: none;">
        <button class="back-button" onclick="goToMainMenu()">Kembali</button>
        <h1>Materi Statistika Regresi</h1>
        <div style="position: relative; width: 100%; height: 0; padding-top: 56.2500%; padding-bottom: 0; box-shadow: 0 2px 8px 0 rgba(63,69,81,0.16); margin-top: 1.6em; margin-bottom: 0.9em; overflow: hidden; border-radius: 8px; will-change: transform;">
            <iframe loading="lazy" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0; border: none; padding: 0;margin: 0;"
                src="https://www.canva.com/design/DAGmvTogSI4/u3XrH33V2fOe0vfKpzakmQ/view?embed " allowfullscreen="allowfullscreen" allow="fullscreen">
            </iframe>
        </div>
        <a href="https://www.canva.com/design/DAGmvTogSI4/u3XrH33V2fOe0vfKpzakmQ/view?utm_content=DAGmvTogSI4&amp ;utm_campaign=designshare&amp;utm_medium=embeds&amp;utm_source=link" target="_blank" rel="noopener">STATISTIKA REGRESI</a> oleh 'Ali Ridho
    </div>

    <script>
        // Fungsi untuk menyimpan status halaman saat ini
        function saveCurrentPage(page) {
            localStorage.setItem('currentPage', page);
        }

        // Fungsi untuk memuat halaman berdasarkan status yang disimpan
        function loadSavedPage() {
            const currentPage = localStorage.getItem('currentPage');
            if (currentPage === 'materi') {
                openMateri();
            } else if (currentPage === 'calculator') {
                openCalculator();
            } else {
                document.getElementById('main-menu').style.display = 'block';
            }
        }

        // Fungsi untuk membuka halaman Materi
        function openMateri() {
            saveCurrentPage('materi');
            document.getElementById('main-menu').style.display = 'none';
            document.getElementById('calculator').style.display = 'none';
            document.getElementById('materi').style.display = 'block';
        }

        // Fungsi untuk membuka halaman Kalkulator
        function openCalculator() {
            saveCurrentPage('calculator');
            document.getElementById('main-menu').style.display = 'none';
            document.getElementById('materi').style.display = 'none';
            document.getElementById('calculator').style.display = 'block';
        }

        // Fungsi untuk kembali ke menu utama
        function goToMainMenu() {
            saveCurrentPage('main-menu');
            document.getElementById('materi').style.display = 'none';
            document.getElementById('calculator').style.display = 'none';
            document.getElementById('main-menu').style.display = 'block';
        }

        // Fungsi untuk memverifikasi password
        function verifyPassword() {
            const password = document.getElementById('password-input').value;
            if (password === 'JUJUR') {
                document.getElementById('password-prompt').style.display = 'none';
                document.getElementById('calculator-form').style.display = 'block';
            } else {
                document.getElementById('error-message').innerText = 'Password salah. Coba lagi.';
            }
        }

        // Fungsi untuk menghasilkan tabel input
        function generateInputTable() {
            const n = parseInt(document.getElementById('n').value);
            const varX = document.getElementById('varX').value;
            const varY = document.getElementById('varY').value;
            const container = document.getElementById('data-input');
            container.innerHTML = '';

            // Buat tabel input
            let tableHTML = `
                <table class="input-table">
                    <tr>
                        <th>No.</th>
                        <th>${varX}</th>
                        <th>${varY}</th>
                    </tr>
            `;

            for (let i = 1; i <= n; i++) {
                tableHTML += `
                    <tr>
                        <td>${i}</td>
                        <td><input type="number" id="x${i}" step="any"></td>
                        <td><input type="number" id="y${i}" step="any"></td>
                    </tr>
                `;
            }

            tableHTML += `</table>`;
            container.innerHTML = tableHTML;

            document.getElementById('calculate-btn').style.display = 'block';
        }

        // Fungsi untuk menghitung regresi
        function calculateRegression() {
            const n = parseInt(document.getElementById('n').value);
            const decimal = parseInt(document.getElementById('decimal').value);
            const varX = document.getElementById('varX').value;
            const varY = document.getElementById('varY').value;

            let xValues = [];
            let yValues = [];

            for (let i = 1; i <= n; i++) {
                xValues.push(parseFloat(document.getElementById(`x${i}`).value));
                yValues.push(parseFloat(document.getElementById(`y${i}`).value));
            }

            // Hitung rata-rata
            const xBar = xValues.reduce((a, b) => a + b, 0) / n;
            const yBar = yValues.reduce((a, b) => a + b, 0) / n;

            // Hitung SSxx, SSyy, SSxy
            let ssxx = 0, ssyy = 0, ssxy = 0;
            for (let i = 0; i < n; i++) {
                ssxx += Math.pow(xValues[i] - xBar, 2);
                ssyy += Math.pow(yValues[i] - yBar, 2);
                ssxy += (xValues[i] - xBar) * (yValues[i] - yBar);
            }

            // Hitung nilai b dan a
            const b = ssxy / ssxx;
            const a = yBar - b * xBar;

            // Koefisien Korelasi
            const r = ssxy / Math.sqrt(ssxx * ssyy);

            // Koefisien Determinasi
            const rSquared = Math.pow(r, 2);

            // Tampilkan hasil
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = `
                <h2>Hasil Perhitungan</h2>
                <p>Persamaan Regresi: Y = ${a.toFixed(decimal)} + ${b.toFixed(decimal)}X</p>
                <p>Koefisien Korelasi (r): ${r.toFixed(decimal)}</p>
                <p>Koefisien Determinasi (r²): ${rSquared.toFixed(decimal)}</p>
                <div class="scrollable-table-container">
                    <table>
                        <tr>
                            <th>${varX}</th>
                            <th>${varY}</th>
                            <th>(X - X̄)</th>
                            <th>(Y - Ȳ)</th>
                            <th>(X - X̄)²</th>
                            <th>(Y - Ȳ)²</th>
                            <th>(X - X̄)(Y - Ȳ)</th>
                        </tr>
                        ${xValues.map((x, i) => `
                            <tr>
                                <td>${x.toFixed(decimal)}</td>
                                <td>${yValues[i].toFixed(decimal)}</td>
                                <td>${(x - xBar).toFixed(decimal)}</td>
                                <td>${(yValues[i] - yBar).toFixed(decimal)}</td>
                                <td>${Math.pow(x - xBar, 2).toFixed(decimal)}</td>
                                <td>${Math.pow(yValues[i] - yBar, 2).toFixed(decimal)}</td>
                                <td>${((x - xBar) * (yValues[i] - yBar)).toFixed(decimal)}</td>
                            </tr>
                        `).join('')}
                    </table>
                </div>
                <button id="show-steps-btn" onclick="showPenyelesaian()">Tampilkan Penyelesaian</button>
                <div id="penyelesaian" class="penyelesaian">
                    <h3>Langkah-Langkah Penyelesaian</h3>
                    <p><strong>1. Menghitung Rata-Rata (X̄ dan Ȳ):</strong></p>
                    <p>X̄ = ΣX / n = (${xValues.join(' + ')}) / ${n} = ${xBar.toFixed(decimal)}</p>
                    <p>Ȳ = ΣY / n = (${yValues.join(' + ')}) / ${n} = ${yBar.toFixed(decimal)}</p>
                    <p><strong>2. Menghitung SSxx, SSyy, dan SSxy:</strong></p>
                    <p>SSxx = Σ(X - X̄)² = ${ssxx.toFixed(decimal)}</p>
                    <p>SSyy = Σ(Y - Ȳ)² = ${ssyy.toFixed(decimal)}</p>
                    <p>SSxy = Σ(X - X̄)(Y - Ȳ) = ${ssxy.toFixed(decimal)}</p>
                    <p><strong>3. Menghitung Koefisien Regresi (b dan a):</strong></p>
                    <p>b = SSxy / SSxx = ${ssxy.toFixed(decimal)} / ${ssxx.toFixed(decimal)} = ${b.toFixed(decimal)}</p>
                    <p>a = Ȳ - bX̄ = ${yBar.toFixed(decimal)} - (${b.toFixed(decimal)} * ${xBar.toFixed(decimal)}) = ${a.toFixed(decimal)}</p>
                    <p><strong>4. Persamaan Regresi:</strong></p>
                    <p>Y = a + bX = ${a.toFixed(decimal)} + ${b.toFixed(decimal)}X</p>
                    <p><strong>5. Menghitung Koefisien Korelasi (r):</strong></p>
                    <p>r = SSxy / √(SSxx * SSyy) = ${ssxy.toFixed(decimal)} / √(${ssxx.toFixed(decimal)} * ${ssyy.toFixed(decimal)}) = ${r.toFixed(decimal)}</p>
                    <p><strong>6. Menghitung Koefisien Determinasi (r²):</strong></p>
                    <p>r² = r * r = ${r.toFixed(decimal)} * ${r.toFixed(decimal)} = ${rSquared.toFixed(decimal)}</p>
                </div>
                <canvas id="regression-chart"></canvas>
            `;

            // Render grafik menggunakan Chart.js
            renderRegressionChart(xValues, yValues, a, b);
        }

        // Fungsi untuk menampilkan/menyembunyikan penyelesaian
        function showPenyelesaian() {
            const penyelesaianDiv = document.getElementById('penyelesaian');
            if (penyelesaianDiv.style.display === 'none' || penyelesaianDiv.style.display === '') {
                penyelesaianDiv.style.display = 'block';
                document.getElementById('show-steps-btn').innerText = 'Sembunyikan Penyelesaian';
            } else {
                penyelesaianDiv.style.display = 'none';
                document.getElementById('show-steps-btn').innerText = 'Tampilkan Penyelesaian';
            }
        }

        // Fungsi untuk membuat grafik regresi
        function renderRegressionChart(xValues, yValues, a, b) {
            const ctx = document.getElementById('regression-chart').getContext('2d');

            // Hitung garis regresi
            const regressionLine = xValues.map(x => a + b * x);

            // Buat chart
            new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [
                        {
                            label: 'Data Asli',
                            data: xValues.map((x, i) => ({ x: x, y: yValues[i] })),
                            backgroundColor: 'rgba(75, 192, 192, 0.6)',
                            borderColor: 'rgba(75, 192, 192, 1)',
                            borderWidth: 1,
                            pointRadius: 5,
                        },
                        {
                            label: 'Garis Regresi',
                            data: xValues.map(x => ({ x: x, y: a + b * x })),
                            type: 'line',
                            borderColor: 'rgba(255, 99, 132, 1)',
                            borderWidth: 2,
                            fill: false,
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    scales: {
                        x: {
                            type: 'linear',
                            position: 'bottom',
                            title: {
                                display: true,
                                text: 'X'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Y'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                        },
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    return `(${context.parsed.x}, ${context.parsed.y})`;
                                }
                            }
                        }
                    }
                }
            });
        }

        // Memuat halaman saat dokumen dimuat
        window.onload = function () {
            loadSavedPage();
        };
    </script>
</body>
</html>